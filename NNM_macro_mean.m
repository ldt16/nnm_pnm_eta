function [y1] = NNM_macro_mean(x1)
%This function is a neural network function training for mean eta
%The input is the following vector
%The output is mean value of ¦Çt


%input vector x1=[rp rhop U poreradius sigma n zeta theta]

%the range and unit the input parameters 
% rp 10e-9~4000e-9 m
% rhop 1000~2500 kg/m3
% U 0.000864~8.64 m/d
% poreradius 10~100 mium
% sigma 0~0.3*poreradius
% n 0.01~10
% zeta 3~26
% theta 0.25~0.45

%normalization of the input parameter
x1(1)=log10(x1(1))/10;
x1(2)=x1(2)/2500;
x1(3)=log10(x1(3));
x1(4)=x1(4)/100;
x1(5)=x1(5)/30;
x1(6)=x1(6)/10;
x1(7)=x1(7)/26;
x1(8)=x1(8)/0.45;


%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Sep-2020 15:45:30.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx8 matrix, input #1
% and returns:
%   y = Qx1 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.8;0.4000432;-3.0628126;0.10000977;1.9613354e-05;0.0010109963;0.11542738;0.55561251];
x1_step1.gain = [7.69265356584686;3.33440962518685;0.500087740394052;2.22236973818684;2.03233275442651;2.00253149277723;2.2610504374556;4.50070840025043];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.3424102082908642;3.2288861958239856;-3.6846700545379547;-2.3150123457017791;-2.8557696508225674;2.9699172464431505;-3.1062740567061797;-1.9755971483439394;2.5989541043578139;2.2520588435116089;2.1098319354230664;-1.7061400255569148;-2.7422189538501001;-2.3494400687327763;2.2964858114699576;-1.5613121223294237;-1.7779535198806529;-2.3464770026553974;-1.7174065934974352;-2.7577399276769281;-1.8508927135679933;-0.93526991653385927;-1.5977152589448409;-5.9611410090178119;-2.1039891318307697;1.9183251466791849;2.1221347937783177;-2.0106087498723588;0.48200855789652552;-1.8221325086407245;-1.0996081883544697;2.2798383066011145;-0.91385747881211998;1.686194443388539;-3.0762749750716556;-1.3595012085000935;-0.49706313546056669;1.7911102001839736;-1.7693712367923093;1.7146614428757396;0.8681892998894466;1.701561454685985;-1.9248150728959204;-1.860231125160313;1.2453128040652044;-0.9818982643439359;1.4026516974291277;1.6626058515290636;1.8826926110499358;-0.60407433293474555;-0.56055009800063427;1.4018774370696712;0.77270438059435254;-0.42258353287603762;-1.3630298186736256;-1.1047141843688271;0.30058281975514861;0.134240763508024;-0.054919814987632855;0.4314562628019617;2.6905308750220467;1.1168311505217965;-0.4420354996590834;-0.56236935161527468;-0.69385828169351704;1.1763457016899672;-0.23433195868423004;0.7493359375705233;-0.2243813719112451;-0.53379034585099194;-0.96524086633992823;0.20022823430316394;0.38650946733137415;-0.13012790012032641;-1.4997240896032835;0.24235037500645748;0.58805612204015578;-1.0227459633055893;-0.39606169854613144;0.75364233224740751;0.54432893160824147;-0.31263038789804065;0.59902080517800949;2.2391675406347131;0.83767790659859698;-2.1620293184072041;0.30496538720142458;-0.8378054665284983;-0.35082061138212267;-0.21924492388283184;0.042078293851820339;-0.15261740409886074;-0.77215099920214958;0.40999875586218071;0.89323158336388919;-1.1334270189188755;0.70203194296403082;0.044996367462445591;-0.4945461844414667;0.59262094902774098;-0.016755523312940435;-0.6862772927029468;0.19210885269403774;-0.7032840384578074;0.24663677249577315;0.66414784821021411;-1.4182854749653548;0.56788006704924465;0.92712118608081329;-0.49016560019317235;-0.13796869038253556;-0.88371376407417479;-0.4713217070935275;-2.3421510107398378;-0.63159679909839128;-1.0522847646501019;-0.55024933063676951;-2.0574484900347056;-1.3865330573037542;-1.9770959391658793;-1.5982984498338946;1.629141227361073;1.4055083966220971;-2.0192331767448199;1.3530727791562494;1.6903114425869707;-1.73884791626761;-2.203001178654926;0.3739751341220125;-2.8043006968020938;-1.4141288041880697;1.5225782645456749;-2.0152762084887672;1.2751155945143686;-1.8094039316998289;-1.7082924343478048;-2.4870659747961765;-1.3231298986320978;-2.4261613815823857;-1.0782650542246879;-2.2258939152867985;2.5253343802132902;-2.6487215666870743;-1.596924935735069;-2.5540825565896279;-4.8478451859251699;2.6577267566604603;0.55418986189294495;-3.2043883043640835;2.5626420807996695];
IW1_1 = [0.53680133486202408 0.15282414952969925 1.375014732669444 -1.01039080504011 -0.58872097782522903 -1.7350524785727068 -0.96451140626669052 -0.55024057686562189;-2.1434992110187929 0.76507286568594157 -0.57546314650043684 -1.3690225595606589 -0.35739217524759059 -1.9747099019002008 -0.51431032252517439 0.0096655751093691379;2.4029037582514898 0.14655638971663634 -0.78119874460119343 0.35686196003927378 -0.83623431302582574 1.4118338156946866 0.44295339706642017 -0.030341251360243869;-0.18846868429679259 0.78832147522636797 -1.2027009771286785 1.4071895104686709 -0.44291265233403343 -1.7741389697540204 -0.0024949157083956758 0.3083769712996553;0.50437672533757871 0.075117776816128384 0.50225392601307928 1.3334555836458395 -0.47375191849886139 -0.38910408242512057 -0.11697215397145797 0.46271317733917189;-1.2402954591412458 -0.30355245975779716 -0.81578717385114252 0.91934100783339723 -1.085566472811381 1.1431173444585481 -1.0466008982972068 -0.010784151135276844;2.8012513464279034 0.48341599668936591 -1.9850996810695445 -0.033034486546928692 0.12684888718602705 -0.89225876197372067 0.59165578578348277 0.1136684556510754;0.21401768453946945 -0.09996043856848516 -1.8081350822421283 -0.2344164156410023 0.1978350717616093 -0.61601407692564203 -0.066275535710277195 0.19781401676395752;-0.59250392741745805 1.9956809353096494 0.62472208830283593 -0.03643307080684511 0.08229592136743466 0.47079390129548959 -0.24529878233802699 -0.056740005673658382;-1.0558708711489255 2.3632727414792103 -0.22112998761549543 -0.13779278555990054 0.28672059485085921 0.074238674352620104 0.010345251284870776 -0.13520785311762964;-3.2484428612820735 0.04623162645106655 0.2541036426301736 1.3149744259859575 -0.085463368321714445 -2.1287268620910842 -0.018455071958257956 -0.12089738538429252;0.71833403085190972 0.16768926764280812 -1.3030637753729037 -0.074546070417791738 0.045359429828793443 -1.1375335463610567 0.2269400192423667 -0.23345907347853159;2.0709536933574966 -0.34413684262702127 0.953022291164907 -0.16091229299873847 -1.7581071752040267 1.5084777174836883 0.12689204647381169 0.16418003311906032;0.3851524708981347 0.052480082435479136 -0.33934158589211127 -1.1819173348877023 -0.83749942330443516 0.16997368602365109 -0.3689618298311812 -1.8681238616397595;-1.0028836399012018 0.26090719298650733 -0.2639175560335178 -0.062033140545066943 -0.3321062172295205 0.20688965010860844 1.5773617318922448 -0.58167676692432269;-0.84127201076522606 -0.37683384021968092 0.70175998065828527 -0.45784202825218223 0.9343551631886523 -0.40790517735113008 0.48874155978990447 -0.65459827969702222;0.90943688174746418 0.8040275764600342 0.83477339291825148 -0.58083002113187898 0.082256787553028565 2.4276592938824568 1.2744542779881625 0.58775807542497849;1.1054249906383395 -0.074369722389040896 1.507613231895633 0.51519517282414329 -0.46380938935214827 -0.77365797411705672 0.5362071558069843 -0.23360887293732557;1.5062213272445555 0.090988212372777891 0.16185450942614357 -0.96046161244682748 1.4877381044496751 -0.15100511176134729 1.2939126273901953 0.81184355802656361;5.1723383763833164 -0.047731655972605806 0.66975100904472584 -1.2931864308994754 -0.17942193714568508 5.1145188210097894 -0.23452793690011614 -0.22500919604760003;0.42383522729988077 0.11708648135351506 -1.132900853577737 1.0133843149302415 1.5337548508498633 -0.8355670415138704 -0.50012518778810189 0.96736412526871962;1.6670803742637934 1.219348165088266 -0.61013335859052253 -0.094180606130640179 0.087415222384849237 -0.052893585173266339 0.27475124678526774 0.03950549151775417;0.25748703620412439 1.5252265364862296 0.34188095303098925 0.56280463477199538 0.42594142264242113 0.36950394420950361 -0.91179764504216854 -1.5966581029685158;1.9866680701550568 -0.12859687890246932 -0.27397492697850928 -3.5221611244811393 -0.86917989717910649 1.5444971626338186 -0.099728570707438471 -0.30322186221835751;0.57047594763521858 -0.07783965457979708 1.280441927333775 0.40239267417335001 -0.65840363007324465 -1.0055766050098249 0.31853498213390763 -0.39983900654653759;-0.15405472775227017 0.69279930680793844 -1.807245439363796 -0.51829134060264026 -0.41357709463001446 0.21265984151898323 -1.5204814931074349 -0.0032591253211153651;-0.67334386551186087 0.24006176322359993 0.17171955970866873 -0.34333250931522813 0.49656120283129579 0.6632140463341879 -0.89512025394014072 1.2189000849784883;3.9452370794260712 -0.075242894709229874 0.26874463534628362 -0.85667406847724303 -0.20580494889637574 3.7129024149407872 -0.12046094857316476 -0.15650278708445403;-0.70860584830949025 0.20681937879524329 -0.76034228847467078 -0.047483851160985351 0.55833075610053573 -1.2928817606549803 0.63536513467041489 0.5741702600545826;3.6993356866327423 1.0638802167763604 -0.76884937233920914 0.087304477451722151 0.24230235898710747 0.18534015921026886 0.3827687498532969 0.10327299518898946;0.94731064421534905 -0.34786213439179164 0.75470286203645875 1.013388158296135 -0.31198971764930217 0.58413828491936093 0.29123069011069352 -0.045912994053950718;-1.2456828832536906 -0.68596569855371425 1.7589687958411631 0.35004206298358354 -0.46708747819973312 -1.060335759633567 1.2639945003623794 -0.41448865212780084;0.2576739523848427 -0.40231661814608016 -1.5812950759578168 0.43671461208037532 0.14387418177972652 -1.334930290310715 -1.1646842041052934 -0.19893494080938989;-0.71239803305512595 -0.47739138258223351 0.77065717401747036 -0.12993052769505584 1.1452961656854177 1.0084550460004329 -1.1580297548204854 0.26848171819978406;2.9207009987691039 0.49292112452701642 -1.7701039675066899 0.057943622279208219 0.088462013161005798 -1.1028794021729373 0.52066269543724886 0.090322802752748316;1.1855143839462923 -0.031813778870743901 -0.15619781806729807 -1.4912605447807643 0.49694279432302629 0.91156687492292154 -0.5738287819097464 -0.26205828786492164;0.005192090608018513 0.36506976120888995 -1.1607866200686072 0.51121821886748353 0.34807449579611605 -2.0514095464621529 0.30821115452494857 -0.14051708283266751;-0.93656742281939265 0.26559490820114534 0.47977903965147839 0.3309367809160082 0.24483208612576018 -2.7700403867287076 1.3474445792027629 -0.96606307532790781;-0.088870179342832006 0.66190588175587539 -0.24014207772149879 -0.90952200413815043 0.85349828366230973 -0.44810894393381751 -0.91658447545801525 -0.96050683890695521;-1.7429759183515603 -0.2131657246292252 -0.94989509941985972 -0.40327888943914436 0.43968345712019619 0.72856585757016179 0.45811017306058288 0.2344764664239487;-0.72919132253084218 -0.17528651801891015 -0.52835276379243679 0.39100332258995374 -1.2064619133334742 0.45490912983655846 1.2343060847432357 -0.87338224936004072;-1.6740844773275529 -0.10979440647643754 -0.18097580572399516 1.1014211710798703 -1.5386812328059547 -0.065922463263165657 -1.4924541147052692 -0.87917947509740135;1.9330043472569962 0.088747199009737973 1.0710051290431815 -0.13131318713400048 0.28712720767107863 0.65588518030671172 -0.11363746807327325 0.11080266014475526;1.2398597562058447 -1.578353051331632 0.76362976035334929 -0.34279263898532686 0.2013323359568551 1.1850153044985519 -0.11463503231955455 -0.12058164043285113;-0.74039884515199317 -0.23478652116266882 -0.68997644129762226 0.31582981614959948 -1.2813753681263438 0.65428171049035888 1.666623795467437 -0.8248095468536345;1.0592353385506716 -0.31771655731325216 0.58014047997318519 0.63816682401375369 -1.7404693140772982 0.17502136406978588 -0.21282382270890043 -0.061256886835904037;-1.9973208774098619 -0.69212675497159104 0.50198876320626029 0.61183709279119292 0.94018645393568845 -0.10711788292625277 -0.59596304405462386 0.37105498854130553;-0.51863045770339433 -0.013978927633227587 1.0442153555105358 -0.91141488466799048 -1.4904742211451703 0.62026216650142285 0.43263015608836819 -1.0480434884348122;-0.63833308488830331 -0.57466365280553677 0.78313892144851727 0.28163171426683314 -0.89323267710510013 -0.88342166047051884 -0.88436550243870105 1.3980046078220525;0.13411313299506339 -2.3834897097803847 0.83003277507086171 0.036946938245763637 -0.42269069606637333 0.35104176466700643 -0.21471659874013868 0.061443606650579428;1.1218211896468673 -0.021686690268975996 -0.14967933345655973 -0.32812074565356608 1.839993559519288 -1.3054881830439602 0.97373275448806618 0.52779769224359407;-0.46780089743056413 -0.13050839010490559 1.0127260486817531 -1.3414937960435218 -0.45213467041089184 -1.460047774841372 1.6891341138445304 0.29954428725244753;-1.0341910528920319 0.17497084856502376 0.93220598823045053 -0.14107512018963914 -1.0696521675058621 -0.86056039466896628 0.82275985517145367 0.37172682085434705;1.5593292504078833 0.22354022971167475 1.0290213779724084 -1.0913878050651122 1.9511808232345793 -0.29507883484458386 0.75516664869508177 -0.50986751318895929;0.451583583643487 0.013671217108483024 0.4363788767719618 -0.20573661833751244 0.50187388941264233 0.19028635792279264 0.6859873690646987 1.1294963975956924;1.2017456647140847 -0.28039801159669397 0.51234045095139535 -0.25682160743683463 0.54315038074646216 0.95418361998120305 0.2592635540593024 0.2056483150087399;-1.3689499650966106 -0.98058500923636716 0.45721221369151166 0.24219479160123275 1.2739786220342018 0.68607741869994143 0.1742174934444117 1.0271629823721076;-0.96827835647335014 0.22109932216793313 -0.75324671514124664 0.22314513588139764 0.23946934369515904 -1.673026597175477 0.51361852619114146 0.28527715413022692;0.1670017838547419 -0.87963177790887004 -2.3891209655823933 0.12054362530927992 -0.18828486454691637 0.40655400875846742 -1.0345539728265858 -0.27067356722448654;-1.3805386095688537 -1.0725621845248947 0.54522822626036893 0.28645634759345279 1.4269938596700005 0.81481340302467664 0.44612524731941244 1.2831200801369691;1.7282413737075795 6.0602846799465526 -0.8267916847161596 0.045570661355357076 0.00072144520798466142 -1.0733759497070738 0.31982008956514807 0.029359425731750467;-1.6642722217073016 0.40095258567268643 -0.57543366527307016 0.23529611929327263 -0.76665476188188797 -1.8292009860643743 -0.3118924128354702 -0.077212596376115564;1.2763507822345452 -0.28984108819095644 1.2299389499383713 -0.12819996186812349 -0.29335283471927082 1.2452691615491294 -0.10441914624620555 0.027465404754045439;0.9825052682679144 2.0912715816949143 -2.0591726666206167 -0.2205205226587422 0.49497180476262931 -0.33145932222796043 1.0578267137062725 -1.2317851954176358;-0.48298384540343053 2.1384675790517091 -0.2857905302772209 -0.17123678963060077 0.12123172688542186 0.63456176583014534 0.049528753541411952 -0.2547105502873665;-2.5855351034934086 -0.081027143529116788 -0.19058404822574171 -0.3955682440352149 0.039046193565175358 1.1148018024288375 0.21761548027524155 0.038304943681122729;0.019183835611592637 0.055597939049525751 1.017360298145618 0.28938145305429458 -0.084093249814957333 -0.36724276591291732 -1.4806519554486237 -0.10130922730737069;-2.7590097542436216 -0.17329311590365082 -1.490508381666581 0.28776259165697954 -0.022286455960673378 -1.7420486091152121 0.72320400815899721 0.31158260054365394;-0.45294185900172418 -1.1358249009158476 -0.1959687301129252 -0.64760259934898456 -1.0087179605974841 -0.53788001560422793 0.036823613401352338 -0.34568050361587893;-0.79343494232753886 0.051560405997098338 0.35822687813403903 -1.5861208264794555 -1.392384792434918 -0.12398370636249655 -0.0061001936563798674 1.2724066192066419;0.34891238404158292 -0.03513564180492619 -1.2224874853250871 -0.56936570470359971 0.38642650589451288 -0.17810316357816186 0.039901329251234491 0.0063213071391880864;1.3391920821972176 -0.20450479215428216 0.32398577593321959 0.4083706791695767 -0.081811069112434881 -0.88511532767308421 -0.26075668249644118 -0.09017866883258896;0.31091187724593011 0.048760924989905641 -0.30704119474217956 0.23264617255805398 0.83196793166431127 -1.2303714932969907 0.36959223003542852 0.033221742514672865;-0.13052297138362839 0.12827173350671658 0.53881458728066178 1.1162326186421234 0.038340412045434959 -1.7655533166006367 0.090027790506963606 0.65225936496616144;0.57375483431446561 -0.33564067776795725 0.74606113614627179 0.2494692722956956 0.14731220894488295 0.54987665487481863 -1.3095326700683698 0.26328438877681715;-1.0973867365990035 -0.18575839562307325 -0.84936760993732086 0.99122289889481574 -0.35726126187154977 -0.96944462605175463 0.11036707537275982 0.70357658416264812;1.364848097558955 2.6579476331777201 -0.65099913958014455 0.3420008888372415 0.25001556706017336 -1.4974523958731887 0.24332537317555603 0.14067882295321393;0.18536190775805828 -0.79358124096008886 -0.53737914431242217 -0.0489263733948017 0.993302989514668 0.78237960386802696 2.0886644646482151 0.45907697320841162;-0.22059997149369959 0.056325079894513061 -0.069555732359736472 -0.79436377757993504 1.0499657040326444 1.0523490057107965 1.0747524650732061 1.2238000640175017;-0.75810882908649235 -0.11464314988837193 -0.22637189730676044 -0.72577701913391757 1.4206764769999836 1.0277147419352066 -0.71438558564742505 1.5503531163201891;-1.2321472197758381 -0.13906383358395777 0.49640855390273625 0.84495761635632194 -0.80683759273608913 -1.2972708421403258 0.39643728398558775 -0.43058387122217912;-1.3494372173063516 0.56580424022432285 -0.41252256491296374 -1.4961603690124983 -0.22476616133310662 -0.16508660086250856 1.228255620042318 -1.2321369638931017;-0.74346000443242233 -0.1241607646178734 -0.44777240429764553 0.4765905120029772 -1.2016655189046306 0.25651495188657158 0.94030462176993834 -0.95393386606964203;-3.4539643576481076 0.010689840882906235 0.26748802675123978 1.530251536342593 0.16264781080539883 -2.3218293906941527 -0.11257137259007066 -0.14434472861224149;0.62656233233868186 1.403976930112689 -0.45413231392117381 -1.771646627405463 -0.2490286033986196 0.71267112572691105 0.88105248143278614 -0.042042397840175404;-2.1249273986880781 -5.1475050440821297 1.2168780126542214 0.054283584148379166 -0.10580253748024698 0.90667055581464373 -0.5038425665517523 -0.085986817523076603;-1.0811902675486293 0.12771676236733331 -0.7973460284259698 0.069128556453125031 0.59413791340423638 -1.5492539738369089 0.58026801833472808 0.55009377030742146;-1.7716000722386218 -3.3512704409616307 0.92260837812988683 -0.32561870079660643 -0.20563635228916557 1.8163590771477931 -0.3064288788501186 -0.13330780827465369;0.36461390889998063 0.0019225981298560575 -1.4025666729582071 0.782009128201266 -0.30982488272253766 1.5299154470343235 -1.0696190532123893 1.1850855407947711;0.23328024657753541 -1.4686843052379464 1.6793416242458006 -0.30271746644783992 -0.17391812823648561 1.3365095531434485 0.073175173536153049 -0.71858153086991494;-0.01699821546733514 0.061739819174430867 -0.40281879658237807 0.32007179354527698 0.65198936211715353 -1.313554284700202 0.27893820736279856 -0.10878984478328815;1.6492345110726119 0.33462423647349304 -1.3880110577577871 1.1460859082352384 -0.35504442178548379 0.46443175152894467 -1.2012787152349989 -0.10379556686755935;0.31669893873069505 -0.14303843983732104 0.13452058240822515 -1.6989256306381817 0.5121367968928171 -0.1716498049386512 -0.21201646902634866 0.011470284150195492;0.21304518911882969 -0.041961342877189715 0.15660095444095445 0.65075634784375225 -0.79035077981022506 -0.9925103769172956 -0.74428737292058778 -0.82704950301354407;0.10594301869983141 0.059923901482850622 0.063277116828030097 -0.72334944866560147 0.9845431842383302 0.72306129643589989 0.8691102036098346 1.3957797981329445;-1.3558479769796341 -0.17842056494972489 0.16908412451734744 -0.40173118340535585 -0.22555265412489808 2.4616193932851642 -0.48291147764845632 -0.33953026353582838;0.86267848461193108 0.19605144939721325 1.4697624188883942 -0.51675966267705942 -1.7571196990409275 -1.0165331631789658 -0.02083316147767781 1.0998186439314144;1.7832995052763292 0.14513776896554534 -0.57138877393733878 -1.0877491679858176 0.48625210565074051 2.395236493873063 0.37653088595463735 0.22130396736454602;1.1183479460078427 -0.13580346213214567 1.6673557480515391 0.3999020627652905 -0.29688573182092109 0.38008519687021847 -1.2308374253307461 -0.22633322733221545;-0.14093644544663858 -0.38228190178019983 -1.6881252388157304 0.29674883263453011 0.44751185832968232 -2.1582218585356188 -1.0520637377130286 -0.23505125290024509;1.4265644076447606 -0.14842437925760993 0.80551134793662604 -0.27184046352863678 -0.35597612479995727 1.9676224327500511 -0.49594318490099731 -0.36222463680186201;-0.10125643972726608 0.0881735010521984 0.48622967429663139 0.53433885861081576 -0.21936691699306096 0.23739397275881949 0.38578577829136756 0.42247379900166493;0.80475534710051144 0.18780264459467266 -0.80877167782325898 -0.36882056077023678 -0.050183014889196867 0.48964195535267263 -0.46627645241014609 0.16703197948554935;-0.59646053282839728 0.096636461739756208 -0.51393240525259198 -1.0495640300691023 0.4924091404428278 -0.071050457689685584 0.23781323436619661 0.067075019376452119;1.1042065003846755 0.015523330132330513 1.1697894927752492 0.54970834097644217 -0.29547255816066864 -0.21464365377832018 -0.44677776959413412 -0.12609297109372564;-0.53733711956557806 0.47123034808182201 -0.70329423273336389 0.64487029523116146 -1.0217219216165883 0.93213778065130992 0.063025904734200291 -2.3889441057207415;-1.1868773301104263 1.410174855665761 -0.83802715459426325 -0.37985508297454806 0.70574947854194348 0.1180786745614142 -0.35734470028214377 -0.63993417212664927;2.4051644553072116 0.72109125483155134 0.12708823246648221 0.20784036147525603 -0.070715436787166311 -0.29012668493005683 0.13183805820028424 -0.17456285612401493;1.2806576475653482 1.6940006919017792 0.49465106138725001 -0.57633374048652031 1.8441578954910709 0.1565749910719019 0.60253872913125106 0.80316249026444919;-0.14631674001159403 0.0070695579596800531 -0.27446310072810354 -0.64240672250572739 0.64451024472528073 1.1547690971705262 0.47315975916360631 0.51336589178919634;-0.71826604660998616 0.17372384682458014 -0.41265791884158065 -0.36840634888853258 0.108287376978913 0.52426290461257341 0.24752985017241871 0.070378762517503177;0.61866306507883917 0.022179927770560333 -1.1634808024679968 -1.2374194777665755 1.7326022430374519 1.3160850638114912 -0.6669096993587682 1.0237495466851789;-0.37166695105643327 -0.11546458857638309 0.93451332800165676 0.46181141811562704 -0.076301068492054175 -0.39340652206472604 -0.89299198693953163 -0.11968926560490335;-1.9253413901879912 -5.4688651705983569 1.0554424491333987 0.011439493729018218 -0.068713076191035533 1.005506975206601 -0.42097008563258154 -0.065694704472443993;0.51511689450413245 -0.13257359161045643 0.9536703688514413 0.042385219924597609 -0.050761130491815742 0.70999109502861213 -0.21030062260653087 0.030649220549162144;-0.5964282813548154 0.56224736204412196 -0.43435000056470374 -0.93987790146195804 -0.54479718669366273 -0.82228812927900807 -1.871449256996391 -0.36506040954348629;-1.0690189061605206 -0.11112665892284115 -1.4136715867034471 0.011082407653445172 -0.044058030153453706 0.16681434142032189 0.41439507643280593 0.080288035818883149;0.11926071990419926 0.067266134890612908 1.0391922833469114 -1.2238955006661449 0.27596628485610647 0.068602680870098978 -0.90770870802668779 -0.023372504340397639;-0.15032555369103862 1.4112751233783443 -0.084565681535210158 -1.2148177660877426 -0.20655854477185601 0.15632642968715027 0.076896217844452983 -0.19414180528395583;-0.75947327041313495 -1.8110385449818474 -0.27312829219608031 -0.4861949935006078 0.44445680507213331 -1.4281332262817894 0.41401992309676366 1.4430653641304909;0.064241735668961977 -0.26579755251440579 -0.66321719760666675 0.65509523421146465 -0.45945147248432244 1.1954430265712754 -0.87106829089269 -0.32173193020626029;0.31284368319949379 1.2262371303569291 -0.30149058086453179 -1.5424875957452806 0.31671884814108742 0.80855843348332002 -0.75345796625015915 0.40477925450431862;1.6289524978525307 2.2210754278110385 0.089051511135046335 0.24735447335346852 0.066251654630476872 -1.1316813378922344 -0.089077599020062195 0.073455704780073003;-0.76094050653144396 0.80615401023094357 -0.21294751598096687 -0.967913729322047 -0.28093009761228271 0.081212191868848788 1.133936863918743 -1.3998163876305358;0.77239566971184725 0.16020265916126913 0.99231907515384876 -0.31286188179592345 0.081656992607523515 1.2366502285942871 -0.059686761602579012 -0.53400617567225184;1.3395249037933792 -0.16446861014647166 -1.4382892889289234 0.90746938107240716 -0.55140208413243563 0.49155756900938924 -1.0705728621719877 0.32113093219299343;-0.3953982772775802 -0.034984761209197045 -1.3811092519042647 1.2288044221548464 0.72011950327819041 1.0047722941962618 -1.7102752913948527 -0.10810472396516022;-1.1303916772871012 0.71162172867452334 2.023364459699343 0.036372702138332512 -0.29517800994226107 0.17312180741595176 -0.70931679391038571 -0.275858252866646;0.34683499604189294 -0.071273679275893148 -0.9893415381338222 -0.45137009674578316 0.16325244081174742 -1.3683559900899904 0.8341768787379249 0.24149126005748703;0.90519326487854324 0.49908272561141026 0.81706614997691218 -1.3231076304780593 0.19285124599228257 0.25689983664174937 0.54153043670952594 -1.1193963986668161;-0.34722101443849879 0.48405077520858641 0.048663383055278946 1.0910325575173649 0.2076005861297032 -1.2641833344827931 -0.37407679136638383 0.26067267762458912;1.2207464136288388 1.3038238031390879 2.070829782467003 -0.79000393250783596 0.30864911802420192 0.20634045715703256 -1.2571183805946482 0.55911187202897694;-2.0475516574825692 -0.028125406944143085 1.0694900565824508 -0.35494095433853967 0.033593787004903682 2.4602258020137482 -0.22517205592361736 -0.13439911798154749;1.8748204834561353 0.005163074953072621 0.55722507431743507 2.1925780783653712 -0.19521016646800288 -2.2501232365256749 -0.63986767180646686 -0.52488656471320172;-2.4896543491452978 -2.6761022465559461 -0.15491768629084091 -0.43697235920646932 0.027870434575167639 1.5165889086220112 0.12046851016603213 -0.029219334907137517;0.78229069720124833 0.23956341068795817 0.97026296144257151 0.10012055882331343 -0.42479720299882734 0.67996731778511998 0.29695339033619256 0.86655640136414402;-0.88861546026547222 1.128577717803591 -0.17105808888344518 -1.0497917270596933 -1.42803582831902 -0.1676215493721844 -0.30118872506056849 -0.97434692051736993;-1.2472134189757489 -0.063652934860516056 1.1137174760910404 1.135312387150281 -0.21807688731549241 -0.59065950932019684 -0.92081900863170274 -0.34731363282862321;0.14052437196047859 -0.7379200069859021 0.72250631610883653 0.53023769198152981 -0.56189960616236623 0.7268147134747649 -0.30949354497999543 -0.96207489970339732;-0.26462375780241554 -1.8281323435657095 1.6353278868031831 0.09297715831209355 -0.448887718167927 0.38407218175898722 -0.5056319047728639 0.45720348766115548;0.090179859510482324 -0.017633495685900946 -1.7186024580674508 -0.10083586293096559 0.03372244499290853 -0.91399498186405748 -0.068263190665624973 0.11623373470382295;0.34259901629448219 0.57633799918924278 -0.16625500790822645 1.6218100139287506 -0.36642777455509129 0.59436410659250649 -0.83811111977112696 -0.03207389792899714;-0.23696419542724603 0.17645591812101141 -0.77886155777299337 0.52954544920027846 -1.6149692408771055 -1.0707231382000131 1.1060980441621318 -0.40373423815194587;-0.87266809551201385 0.36082338583189255 0.23492249458076395 0.9014023327314481 -0.71375102511472077 1.577767562535775 -0.29200837406340485 -0.53155998762766321;0.32643535709274052 -0.10193382981912759 1.3391311524291911 0.58763615976535866 -1.0259266523055548 -1.2366880058231975 0.17049851662249943 -0.63586891055858652;-0.29034810255614663 0.03227247715796034 -0.11843828799788257 -1.1263898547823823 2.0249984606707101 -0.061643541065025287 3.1497505773672225 2.6641425973907729;-0.26941006257956956 -0.023964405292034655 0.48864574641805236 -0.76232676912341812 -1.2847507698715737 -1.3030920325148121 1.3569588597227511 0.43380836718946619;1.0789931156166994 0.068150659204912326 1.5769318349263768 0.39193306185126559 -0.24443201820363386 -0.41303094688253988 -0.51913615560770465 -0.13547217481765031;0.31303876570514416 0.011405561826951141 0.53719595195203906 0.93362232503693598 0.12590414836153921 -0.050172351676418085 0.85536161239161168 0.9389928673050546;-1.0333415416102547 0.28090454416860211 -0.14021696693466426 -0.016041021609407756 -0.48631765508968788 0.69349185014384496 1.6046194040866715 -0.6686806013406269];

% Layer 2
b2 = -1.7780773161967454;
LW2_1 = [0.057225393049788367 0.25977662787030581 -0.61961576774079152 0.086430792740247675 -0.37553611718084012 0.27273716253435598 -2.0029046543463349 0.98606165587209815 0.32746666873566993 -0.23700354779824154 1.8973971139301755 0.54409921725729093 -0.27677285994708828 -0.089917096265400925 -0.88826379570114034 -0.084021336478526901 -0.13859825813895441 0.62992789736961419 1.7605144484522599 -0.9107294061351523 0.37208841152666378 -0.23415445393975579 -0.014145423256571249 -1.9521037736947817 -1.2640398473649328 0.074241038508494075 0.17065931073444029 1.2401462397578373 -1.513721705514095 0.16767385191709583 -0.26673885497671362 -0.11362694715257333 0.098493569081693003 0.12131392521497614 2.0887013915236206 0.27270525889516323 0.26449220371746623 -0.06284817560345729 -0.065041016459691056 -0.34050289566186831 1.2765034846654142 1.2910210071181376 -0.79104638491329293 -0.27844526486331383 -0.48664431476680992 -0.13428361920074897 -0.12129891918016707 0.39853184150456084 -0.065076050186757523 0.14822591385929593 0.1742815625398014 -0.1095608264716415 0.059598858307303888 -0.052101047181587583 -0.68451187840333672 1.1777432907450391 -0.25486063736767239 2.0660883553412011 -0.033206527526041307 0.19079554077273811 -0.95109239400268752 0.25797997981490706 -0.42653212659335116 0.037581633835063195 -0.099098730936234405 0.42081759507072214 0.4071102731624382 0.19842605809322819 -0.061109949053730253 0.019791916859418997 -0.86153235093376546 -1.0630894840592142 0.96997660032038346 -0.10516218518592182 -0.39096180144051673 -0.19353954464796985 0.5906365399341198 -0.080572241865924626 -1.3806752535743227 0.084825368535008855 0.36101877772473973 0.043214659662303728 -0.85131332220968969 -1.2977334760030543 -0.0098677129588751432 1.5046795653529073 1.586729899024838 0.61865872643934294 0.039200401578364158 -0.073889568066445449 -0.96599450108886586 0.040016347511989993 -0.19916164526284669 -3.3872784580539497 -0.21287146318589331 0.19256178555880232 -0.023113856141069852 0.20045255738014847 -0.26155869696008899 0.096679929613833399 1.8760704738587621 0.43715739933847253 0.30465522986767907 0.53874880269417458 -1.347363445269057 0.034956661057039137 0.056934638985921437 0.16776524512845725 -0.037524395279107677 -2.0762564572004494 -2.1426844277415831 0.1173731208667087 -0.81107879382492709 -2.5163326199230656 1.7468681988813968 0.051609013386543889 1.1011680262506496 0.26229794834470743 -0.10754376312374606 0.021629238212179554 -0.14290840511464759 -0.043649987471925326 -0.70329528983233114 0.064787581296631314 0.23505791284284427 0.035174119276321143 -0.058488634881555847 0.10014941908826648 0.18035000825292949 0.22670290804650903 -0.15995243266000189 0.025858846760160637 0.29461729824235849 -0.052284671798821958 -0.533587631495822 0.37468612877168422 0.032690932291704076 0.15903279429442732 0.29129021615011197 -0.1165981461439056 -0.94926889215239185 -0.16210047119314816 0.17459575521511675 0.096664628285652296 0.57549355293283955 -0.34986169448689963 -0.11050135458097915 1.4145862570690892 0.95135714392215787 0.62876469563906767];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
y1 = y1';

%output is the mean value of eta
%which should be limited in [0,1]
if y1<0;
    y1=0;
end
if y1>1
    y1=1;
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
