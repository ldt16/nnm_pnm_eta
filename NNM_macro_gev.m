function [y1] =NNM_macro_gev(x1)
%This function is a neural network function training for GEV eta
%The input is the following vector
%The output is three parameters of GEV distribution [kGEV, ¦ÒGEV, ¦ÌGEV]


%input vector x1=[rp rhop U poreradius sigma n zeta theta]

%the range and unit the input parameters 
% rp 10e-9~4000e-9 m
% rhop 1000~2500 kg/m3
% U 0.000864~8.64 m/d
% poreradius 10~100 mium
% sigma 0~0.3*poreradius
% n 0.01~10
% zeta 3~26
% theta 0.25~0.45

%normalization of the input parameter
x1(1)=log10(x1(1))/10;
x1(2)=x1(2)/2500;
x1(3)=log10(x1(3));
x1(4)=x1(4)/100;
x1(5)=x1(5)/30;
x1(6)=x1(6)/10;
x1(7)=x1(7)/26;
x1(8)=x1(8)/0.45;

%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Sep-2020 15:30:21.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx8 matrix, input #1
% and returns:
%   y = Qx3 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.8;0.4000432;-3.0628126;0.10000977;1.9613354e-05;0.0010109963;0.11542738;0.55561251];
x1_step1.gain = [7.69265356584686;3.33440962518685;0.500087740394052;2.22236973818684;2.03233275442651;2.00253149277723;2.2610504374556;4.50070840025043];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.443651164738371;2.1820902450943662;1.6581150119272978;1.4726446945574214;5.1786673266695997;4.0434310212869802;-3.8304148783229244;-2.1179031797368095;2.9466852354448609;-2.6031597247287954;-1.3095954179414935;-2.1595579034100658;-1.9781962774287081;-2.569682059088271;3.2282403025293784;3.513430361890733;-1.5608271142085914;3.9828218788984939;4.7450687256196247;-4.1120958123480165;2.571793202640654;-2.1981578290634056;4.3962696552182594;1.9270940251444753;3.0983427822684115;-1.350248256327917;-1.5947354174453476;-1.4107910698384467;-1.3596819086418153;0.5282921093600591;-1.4606334007542836;0.9493070314548091;-2.8186001592307979;-2.4097254883752401;1.2322806893548812;1.6603273416653159;-2.2994876265262332;-0.51669842463696669;-0.84487017320524749;0.87247469128002242;-0.7983620882223198;-0.38836309668558794;-0.96417120418763202;2.5668306880643819;-1.9796227804837574;1.9857086776183928;0.91780371396186233;-1.2899430048017051;0.26944019806804531;-1.7905855190078968;-1.2515524491607954;-0.57468524728201376;0.088567404753913614;-2.2836854194973735;1.0748125306125733;-1.1964611557885902;-1.7290004778403583;-1.2112364520621788;-2.1799593810625466;-0.41421060330294324;0.55778998867438712;0.45926285237406156;-0.54075092769614064;0.27975396723696877;1.5603657188273607;0.70576717425755897;0.27356593195005013;-0.56318993936520534;-0.1531463596665697;-0.54651824463721899;0.5567319851046143;-0.57156033305049303;-1.5703750600718358;0.49412026909753609;-0.57178781605416507;0.23497463865763321;-0.29564742051791237;-0.89481136162934982;2.3281436106082123;1.0166000182578947;-3.3686877974551082;-1.1669416588494059;-0.16528322568709289;0.43329638710803137;-0.52163597645776349;0.037987929123219202;0.23842486406296531;-1.5851134711296515;1.0782264570599682;0.20878457732715788;-0.120524453732967;0.84729844430832024;-1.8279828686132797;0.78853458516063601;-0.50777654617329038;0.53592757017431647;-0.92842675230200622;2.0620132905139585;0.83333596609989102;-2.8277233759749487;0.014626329155688334;0.65465931776415531;-0.9581451261951065;-0.41108496351280954;0.83261113045123125;-0.68858401980068706;-2.0707640972988641;-1.2230959472443168;1.2283913138566132;-0.45961030127267466;-1.9404168821028169;-0.66360254462722468;1.6781522678818648;-1.7769310222487171;0.019733290053474892;1.4853103779934587;0.63850476618984853;2.3325178617557527;-2.0597087006869952;1.5945638620232665;-0.59733469173457598;2.2717168084667101;-1.9400661392579261;-2.7592932824581524;0.67637116761139982;3.0416944042458978;-3.1596083701839368;2.8429621663946727;-1.8782357900499351;4.1936561984207144;-1.9962525037236678;2.1854020969360421;-1.6670715904570566;-2.5561027669983409;-1.0943266266265748;-2.7445229074618558;-1.9886863678907203;-0.35427141284150504;1.0823037001993023;1.2133950769016653;3.0952386421345306;-1.7014934445577834;-3.0291748257426194;2.3048236297064255;-2.325231472697975;2.418025968389995;0.55406715957602337;-3.1971739316849748;-1.5020726561345676;-2.6841422246509503];
IW1_1 = [-2.4185159799354112 1.2509017744114568 -1.3006978593654521 -0.17805203732657149 0.34631416837533269 0.35248242030842686 0.50657344231267987 -0.033921257620459715;-1.9960372840342 1.0004571066275261 -1.6035633410785333 -0.25965117118959929 0.39022781270943258 0.42356264261893706 0.57304749854641845 -0.011721333240474082;-2.2158548856971936 -0.072991901903076709 0.042214384075092551 0.62547163101524073 0.049741808150616747 -1.3696957995597865 0.2033654568715571 0.17259539733295326;2.3957021977165183 5.0795667783493741 -1.6305564609633241 -0.036909967252204391 0.14028714345531462 -0.9430721003590159 0.54900150331195274 0.11889221085864314;-2.7424738672172575 -0.18281613650461165 0.013093050276168011 2.0854524974931055 0.4104831934568301 -3.3863065509262333 -0.20722983762871236 -0.23642228830217782;-6.1296595972048555 0.075864757027029397 -1.4248356913183504 1.3013451237058444 0.28468968460784849 -5.7236543098192447 0.52133423549880287 0.31458821664348502;4.6847094189203409 0.013139677813634395 1.5494851774368816 -1.0719372737316122 -0.51191588744103711 5.2863626200148097 -0.49357614645465153 -0.43041005526472847;0.49091214097380087 0.25142537600385167 1.0269081077263715 0.4628439985635564 0.19852058647433937 -0.67953858510563558 0.11981632938640602 0.057340987659684609;-1.4952137401154122 -0.15195943583194146 -0.7737757380413236 1.1031056044516281 0.60946590825393454 -1.4834688623078178 0.2305300405047305 0.1585981672108894;0.2603268141109602 -0.81222964203080339 0.1001526840829902 3.0198553956810348 -0.49243384099973392 0.79511868886022852 -0.43508020263302916 -0.37139008658613953;2.1450133635572324 -0.017351244286531332 -0.070093680022083688 -0.39426115423576913 0.2727434705891727 1.9921339155118865 0.080149730094576141 0.30369321026943807;1.4201531782526888 -0.047364655859081485 -0.38673333730506004 -0.80123525976555543 1.4434161097443061 0.046772573672795241 1.7210443060790199 1.0032309187041295;2.1551348712653229 0.13996888163883284 -1.5408299744224652 -1.0472627411215087 0.4322278940390587 1.5683394662906152 0.60711598382621057 0.27369404976334183;1.6276227383823649 0.34414712272766573 -1.822312049170437 0.23227557226130738 0.28941413701482621 -0.29280804121128801 -1.8455959996605995 0.45975326444039288;-5.3340458977219631 0.076383063029400705 -2.0118905855043949 -0.16128594929773937 -0.3927417024933651 0.53998422306920923 0.45788245383067139 -0.057196071661126058;-5.7387694794526372 0.037459278648000478 -1.0785892509856541 1.2192936131496652 0.21610399248516851 -5.3768918315384333 0.34355930090780229 0.28833713480428946;-0.012005491629846356 0.29634181607337678 -0.58954905221356579 -0.61695256349028882 -0.5943575629200275 0.36495422802014837 0.68354285966347783 0.33039147884096309;-4.7561193978126486 -1.0018331995953424 4.018427078886214 0.14656349135435734 -0.34700558997198278 1.9950039651272613 -1.1408620843004464 -0.12443848234414148;-3.2155259370600411 -0.048896064621513531 0.27553168479199225 2.816819190331608 1.0434909837904744 -2.6247247094564776 -0.12300389911761202 -0.029268210118057619;4.7516832133483353 0.98982756288786111 -4.2065876196012715 -0.19672068905583093 0.36678146620824348 -1.9330836312997934 1.2067160936158119 0.13763577586387302;-3.1749903580939951 -0.25466168546338719 1.0740468161602779 -0.25792550846469614 0.014489308401679975 1.3559549855904831 -0.28319131957626159 -0.066312995455590162;1.2474142942387823 -0.14008393819074969 -0.55570256322214484 -0.70560880041280405 1.5222717757508233 -0.24969147391580945 1.5322829421224682 0.85051904573228787;-0.56990074225503118 -0.0020250490901038446 -1.0137857101449594 0.95173045777312415 -0.90352662039884035 1.2710739398956836 -0.90302364569389593 -0.9523223343903009;-1.1973036386219809 -0.016549410477890474 -0.89402577046913734 1.0321902255855773 -0.20350943261146889 -0.97583208750522665 -0.43206297928702114 -0.67729061852628436;-2.3308792384743615 -1.2447881422189677 -1.6239960098883011 0.30168767325475587 -0.15287336942785368 -0.78430730584526942 0.33201161663038853 0.18560224650556861;-0.12196034337467565 -0.19253500673888971 1.8157902800318848 0.17314154341030624 -0.037852394792969285 0.26298546570588677 -0.74193712623114327 -0.048558868255773727;-1.0217931216532969 -0.04012398103950815 -1.0404769711986639 -0.26932417610731207 0.92631575843117342 -0.69613931429058529 0.00036290530206341829 0.55536223805086926;3.2770876481887958 0.20914035870213263 3.3172427313870583 0.12365085552462447 0.29375447845435992 0.56773001188311922 -0.62472097391565673 0.15903812701950198;2.2123175299770623 0.93426052062517206 -0.18083922469602756 -1.1136121255111033 1.7318024431781953 0.23961603287901928 1.3073766843580865 0.8187687615347824;-0.56352092986722813 0.22794196244909598 0.4975828433884697 -0.12907493748195342 -0.033018936571568937 -0.26236591237073115 0.41903236812042122 0.53986798329506003;1.2986513162116642 -0.015770389520505353 1.9464651500780097 0.75649526812076628 -0.95019726700208273 -1.1118169814825769 -1.1246934172566463 -0.88902216960299729;0.11820530449379843 0.21861039265049892 -1.3130318141844897 -0.11961425209578422 0.11835717136067314 0.034693620726549079 0.67553098677886014 -0.061906906268494176;4.0196816603635126 0.92670386045108666 -2.0285384364692076 0.21728711343941487 0.028831442068361812 -2.3093827374049423 0.44045441793405904 -0.024538433791774977;0.97847795678246008 0.17915273592981498 -0.82594643442435456 0.68092273647328438 -0.12180070477054418 -0.71736761473496724 -2.1647349192925209 0.063991912752038846;-1.8433073366801178 1.4887163276388118 -1.4386562189550625 0.31284505562263354 0.07085631780166439 -2.1843563781054045 0.44275423327868718 0.056803735411766997;-0.3527031851202751 0.13496914963589401 -0.65726429192590119 -0.075267244273372252 0.94775641721913961 2.3469510751055056 -0.09977806206488378 -0.5600578132897257;2.0973272256842588 0.11502279583361906 -1.9207319827363742 -1.152396858003216 0.51955070354167165 1.6121040070908188 0.73967798390257145 0.30361798884208185;1.1755323859117823 -0.10367364129255804 2.8813225393524351 0.50266310731131725 -0.35025097287710427 0.60946925175084932 -1.6698668272175448 -0.42011403456737706;0.70409060272826696 -1.0953093316009068 0.70644225138181693 0.0044414154296987963 0.15529877539446812 0.99173173436077722 0.10496465849215791 -0.048366338250157077;-3.0638218020421917 -0.56398698150562643 -0.22961294031012167 -0.12898225112747774 -0.079911464211632893 0.49645510550796373 0.04949560380353616 -0.021885372165303271;-1.4204768137315014 0.026359534070394378 -1.2296398840340068 -0.28353440225123566 0.067576832724978275 0.011321487873887391 0.87392261150404682 -0.010706483056533647;1.2150003219732874 1.9682105659459224 -0.65792854672276913 0.25597871975785863 0.027371821242493252 -1.2239336749145433 0.24572577688257982 0.055013369654548235;2.7923659416234279 -0.085777284544617666 4.8105673842327121 1.2827623266033008 -0.65851646876135728 -0.67900701427141774 -1.245183237440546 -0.15207512515173366;-1.8550203107925003 -0.0088981511922078815 0.41905153724698868 1.0768233114743304 -1.6512259273134791 -0.44768174507880387 -2.2761225402018721 -1.3642463798944267;0.68581324193486737 -0.27051973746953351 1.6854141200767718 -0.68065622857705343 0.55838183196582813 -0.55066476513310025 0.88210906645846521 -0.40416185851848041;-3.4334080308800266 -0.05091445113295668 -0.032094897865809734 0.74834852113319605 0.011310826149736181 -2.0830990588612814 0.15549767201226641 0.034191781201259236;-2.2985273704871991 1.3964492713934091 -1.5849355174063746 0.26005588267929319 0.13243299501789793 -1.9849473840714431 0.6443659592495361 0.0016033699265704377;2.0736458274203602 0.75511547391254208 -0.12611051186965652 -1.0896700485223993 1.6541651194401448 0.26756223381132532 1.4547047845203223 0.84093405005144395;-1.0310206772933566 0.19497512013962354 0.52317540465811718 0.10231573902162198 0.11361333150283361 -0.55629627978055385 0.52978889992168754 0.64425299738978203;1.3256553399153261 0.40928978041036101 0.60230656474324185 -0.4312042873022236 0.21097037844056801 0.28727674553904153 -0.13178187068993244 -0.21439470623424503;1.0318195991081898 -0.020186815229668881 1.9417530988379801 0.74115955348857154 -0.79540652176752791 -1.1973121036775953 -1.0728902340599904 -0.74541280061446691;0.26813929869732928 0.044771593749275668 0.61127682013909268 -0.30449669960874487 -0.14829069723070085 1.2663094345065 0.38922365238942797 0.036614600776578021;-0.098948209757183658 0.014163104102278036 0.83967613693453846 -0.086938061990104454 0.36185225086120398 -0.14777763518158188 0.53478055876105302 0.4757964499315388;2.1815899288784424 -1.9982036344177643 0.082161002644849226 0.98637898903675791 -0.86886621965412103 2.3783708070579634 -1.5448881084532566 1.28054497961373;-1.3675495771992947 1.6861777844808843 -0.36546190787205612 0.6025900651828664 1.9331181123115353 -1.4504603685454172 0.27378282098964102 0.28873262273517036;-1.5280110737162469 -0.5989569835029025 1.1593558511699904 -0.20672124993372154 -0.22250098117545822 0.7502375809990649 -0.32553388844979819 0.018881923263811405;0.27691520861009722 1.2949635922938645 1.2931344379818761 0.25069636618335639 1.4347658576508739 -0.52781910419317624 -0.7372068616438574 0.55040348239071268;3.0841141171569331 -0.0077275060428054097 -1.0288341638136975 -1.697651981308351 1.1484355071538987 1.9127647713211855 -0.92025129005974371 0.76066730939706595;1.977561594512401 -1.8105023710843728 0.10375456216560588 0.89598446220734429 -0.84225431148462426 2.2098308669205151 -1.4984751208579066 1.148751499128861;-0.089868428527587002 0.10991003920400641 -1.2364110732856897 -0.11149768102986417 -0.22800636295883708 0.40691548443705339 -0.77529340404262514 -0.22229782492005745;-1.2085478001091281 0.16668029120957101 -0.79183428373990794 0.70234439811495697 -0.12180686669959766 -3.4099032825734295 0.51770514643190457 0.2608694345525992;0.097164457661670742 0.1015364273463952 -0.73310555315613968 0.33627681071763349 -0.17748914389203529 -1.322536950909629 0.30646419328172836 -0.10997926733559085;-1.9124580184413762 0.064830077711114986 -1.0276210003208046 0.21069453141796066 -0.84846368406529771 2.829819412777125 0.0018177168887265581 -0.2483975237252064;0.25038979445695386 0.18730805477394419 0.28438914697877166 -0.63354565132507423 -0.51280281930333071 0.32727167190669532 -0.050956830591537751 -0.5313760976130576;-3.2606405140963912 -0.01690588739363439 0.17687614932024431 0.94929085038227234 -0.26245878425725905 -3.1783061284665601 -0.16351119419561733 -0.1623356860213053;0.043310635158214157 -0.2169524534192212 0.18939384957303174 0.69812427635221364 -0.41426492470716064 -0.32519293159921553 -1.0877143949276113 -0.8715186908126239;-0.49128722271107589 -0.16458790450066391 -0.010922575488666713 0.18825227568259428 0.72526865948831487 -0.36597902030329255 -0.58574430950526002 0.12527856380727923;2.0603673345077387 -0.014270238650259781 1.9766378924140475 0.72650381143706333 -0.54628636352015436 -0.9822771025108793 -0.81321728839258201 -0.31169122981933206;1.3366729333595653 1.6118500649302194 -0.5773127152420181 0.22525122813677861 -0.023315020774687084 -1.1449258654410428 0.19113721295764458 0.043503369104586131;0.53517299435934651 0.35138954176454329 1.2893798780776782 -0.86506926889290003 1.3049810209920956 2.3986922136978786 -0.052509965480790295 0.37226517937055403;0.39476818748795911 -0.4251176646906823 1.4304112037992631 -0.13419625146837877 -0.058689097701492499 1.5850534534521739 -0.53640912254808748 -0.28816365274772754;-1.2395463562792977 0.041494417285837124 -0.043208847945977243 -0.4096286266332258 0.13280576031391547 1.652311030037968 0.015850133402848413 -0.071660052411196495;-2.5736025108691711 -5.0695697291089816 1.6329694101730818 0.013184556387874011 -0.14533249073666168 1.1704895220227811 -0.56508824226600685 -0.14525076491003108;-0.83201281955511153 0.038643158937605122 -0.42380932073698624 -1.0574059553919641 0.096952297999629025 0.79643530649552441 0.22271909421392294 0.096014180956527695;-0.2971851221637884 0.87333776923851725 -1.8173649508902197 0.36886272899241984 0.01357709903370803 -2.5534779688524565 0.60597196972754219 0.22407886872254268;-0.05175414755877672 1.0288767461051216 -1.2777818382002084 -0.46175101968856763 -0.21741670743902966 -0.37181410015039423 -0.46669411336806471 -0.20034049963003164;1.1181614403964122 -0.10659497592517017 2.9180105050794167 0.54516332775929732 -0.2128138636125339 0.46255438196426318 -1.8301131229408971 -0.32638421069194856;-0.33613556154287344 1.5120851531591959 -0.86828837375057177 1.4524823486275971 0.30869946594745884 -0.48643220815198907 -0.14236933335925936 -0.72002532763888061;-1.7449673656809708 -1.2877362449773928 -1.8280765347995707 -0.93128301183133111 0.17726639547465067 1.7690659461506313 0.55334340046914343 0.24490701463099909;1.6333988658547713 -1.0261175863072978 -0.65735699635249745 1.1622395481305667 0.18902682315919797 0.56555205765436112 0.1511231545546784 -0.23544119043616024;6.0550639800682431 -0.026870882888641621 0.85391777814658454 -1.2553095611870806 -0.15335970664569865 5.4706840672610255 -0.22529018336419368 -0.26984177411056776;1.3420369352956105 -0.010495795516882608 1.6347537867553141 0.66826375489262457 -1.3321119787235902 -0.60633215932395168 -0.67778190594009879 -0.97585380389569298;-2.4225875405813913 -0.18561772766471973 -0.7275272285545058 -1.1905306608251356 0.56279438883809196 2.2923213623264016 0.25719039377694408 -0.23709406654685367;1.8158360829783642 -0.094102403875337928 -0.50195658731531489 0.56799083789726867 -0.20488212545032958 -2.7887558028540056 0.11392770566926838 0.18880945562310697;0.98101588759415514 0.0031163755703152189 0.32631082871207084 1.2001852754032394 0.0042026532601748545 -0.79992859835720087 -0.30876500126232881 -0.18268839855157207;-0.88645077176951281 0.031876210291275943 -0.067616301431633469 0.44996539061992957 -0.047892435687843404 -1.6578794831071584 -0.0037631776445038352 0.031422604810598866;0.2436404486611756 0.032525454871106203 -0.68064939482729414 0.0058080511374208896 -0.22874683571559618 0.16611080882650742 -0.28303095356890734 -0.36563592028795511;3.7805872708105808 0.032702782389428198 -0.23555443967369635 -1.081675568578556 0.19466222304718489 3.3574220427470958 0.12650220569847895 0.15033694468700953;1.2776070740629062 -0.53746053101884461 -0.10743699542637178 -0.73106122256655637 0.34738537154737936 -0.78158535082491953 1.2284170745329999 -1.9919308422382132;-0.11502939453532847 0.09711625709497114 -0.7706480390386159 0.34908686170224174 -0.2421734378072482 -1.1733863489735736 0.022540658556582445 -0.30817043186080295;1.2108082900454589 -0.023587786566386115 1.4543042207389316 0.50846515357131661 -0.37709916438252217 -0.79057345050343164 -0.56646749771619564 -0.23903363665771518;-0.69063253980382588 3.6806697159097119 -0.38620696920693637 0.050690748153453223 -0.081242808692804522 -0.84345121157092928 0.14380632204437499 0.099879579681477287;-1.7214692475935491 -0.18696142097820731 0.78102638811086966 -0.43070071671004101 0.093106977670611005 1.9747559103643095 -0.33770425921484915 -0.10676501512406894;1.080537246280765 -1.0490118240727011 -3.4623763208171647 -0.41595567406283651 -0.26293029675671625 -1.3986155947454419 1.2753643473335119 0.32644163925630276;-2.2483707953026766 0.097702548393039892 -2.9508318860281522 -0.73298513742596949 0.26004250404014684 0.26235988122444837 0.87021178580313807 0.31019581624571196;2.6673552108864045 -0.49018408770666932 -1.1845709856894826 1.0884894539119332 1.4519413285673088 0.53826354052655068 0.79873684532733147 0.55822219540037776;2.0337663665766326 0.5033290144421787 -2.6306279071469261 -0.13416119687628372 0.26042639517300969 -0.52485961582756668 0.74080706778856775 -0.04221673277241058;1.5334114778388059 4.9247964002352926 -1.0303928120760613 -0.01908670467510961 0.065760125266369679 -0.82699631038906241 0.34662066053064844 0.062074528465648739;1.2267315417305502 1.0865699214975397 1.7859092979513529 -1.0936976038207664 -1.3775493844807969 0.95667716634573374 -0.74029827319193209 -1.9944613993564861;-0.4336235696618016 0.12329831928221723 -0.45559087595068409 -1.3745954046622868 1.6678259847631924 0.9932289400101959 2.3027796285212769 1.8861420159667392;0.25443452821125817 -0.076847331514426104 0.79933468494167259 -0.38289951506282766 0.26582878451685626 1.1407884630009246 0.17547165817120114 0.48997307225022624;-0.4863544935911846 3.1121422702928458 -0.32035001811709524 0.078390908988751049 -0.051110250851865754 -0.8085760568286976 0.12147656780863229 0.10095739800521397;-1.0978894149450031 1.0178554507168314 1.3772748497005878 -0.54323169690919448 -0.68438018591993222 -0.2494099999413249 -0.4512974729305097 -0.075589536870156848;-1.6586286568868964 -0.043043002288622803 -1.0792064983549308 -0.56194257383045954 0.249768788421493 0.42806759829145913 0.61864922958777124 0.11916847405122744;0.61493112206544476 -0.82789089892013679 1.998854981075936 -0.28595175863725431 -0.024576317790361287 2.4469821787926507 -0.70155039620128545 -0.2331593294859434;-0.47151782452659813 0.34201549995767905 -0.60487753929440824 -0.29594886840293821 0.45363430927192494 1.1290493431362361 -0.10901992999407488 -0.078738714476441901;-0.91965532906147374 -0.14963407088358718 -0.66413107668330795 -0.77951357402654553 0.08188743126970488 1.2248546895391843 0.073819066165321787 -0.17684089216708743;-1.4400687348467431 0.56075571197417662 0.060260396555869837 0.82505432205658014 -0.42455254342902221 0.76994112001054293 -1.3556200183700517 2.0230612838076505;1.2064682530958015 -0.13363803913438135 -0.78247485506807413 -0.06129194068843706 0.13687214438535891 -0.77485682847666271 0.46719684942639816 0.15765228923373667;-0.43294577638150678 -0.25116587543867863 -0.68181498597545276 0.58316327660461653 0.49121892322844041 -0.32820842836969544 0.17792513773300428 0.66260334401303222;-0.28818502327643586 -0.01963409394858279 -0.21808017316834169 -2.0009735954007883 1.1543958719932346 -0.32111271596127222 0.19738505343784701 -0.022760967350808521;0.96820651760471932 -0.1743594905970611 0.83721683378208345 -0.71466305784905526 0.11460870469739007 3.4568490887348653 -0.55274304985830403 -0.29134647298032129;0.0075868860897421227 -1.0393509796549072 1.3899247183647547 0.94072134389932716 -0.027103956610973663 1.1386424500792731 1.3385177978136795 0.55826405204029161;-0.54159313579494739 0.27789787761477835 0.091828475155737443 0.12937193517304713 -0.50869322028311481 1.5370618023914975 0.72322614245506567 -0.58729656149483278;0.77033478458490401 -0.11414631278292353 0.20198083845910114 -0.42693622023631239 0.027508698059795479 1.8333123647726335 0.010837138317745821 -0.025030581940184513;0.13672005070434701 -0.29096505551765395 1.8823118972147874 0.06809915543338893 -0.07763460544227975 0.94478776717185642 -0.37183280270109254 0.092266753805018309;0.066810130366433795 -0.069235754948301975 -0.74878246744819399 0.34623229576575859 0.48242466349407043 -0.58149674443146593 -0.51991948432977697 -0.38183028523930768;0.57781087832783351 -0.017429571512964419 0.64622364536579535 2.6633588151084195 -1.6841884137854173 0.21821142596215284 -0.30033853481732675 0.051461396220647583;-0.32252688088409243 1.9216016422153499 -0.31275486142495856 -0.28771561281723917 -1.5934676188185581 -1.5637823180234174 -0.93599094998508225 -0.21588242028018745;1.7142453800526425 4.6000749902951297 -1.2497632606713964 -0.08072763195779481 0.11141999038288342 -0.65309542963906109 0.43531749436330602 0.062150091486709629;0.35578051317533499 0.25606699018570644 1.1404351733746159 -0.65011776155433609 0.9013938905411456 1.9931598527363048 -0.090206638024452432 0.24385092072856712;-0.93750164726995122 -0.154025296911486 -1.3177030583078893 0.83572180331690626 -1.6372932000056031 -0.97802028652722561 -1.5143185958133938 -1.5231327457859718;0.51176554150643838 0.093199232937243442 0.75964815963318444 -0.52256543311545589 1.2333708116912687 0.3775028406694535 1.3371280807085875 1.2009782580992492;1.8990299006156595 1.7490755481041207 1.9423824641339764 1.0688109961236452 -0.20467463813709355 -2.1322529157197483 -0.56569619020640483 -0.32137637350959219;1.6021212041051087 0.0097574900635709703 1.2692457527925864 0.1928369426926281 -0.12089301440757244 0.01297465438509233 -0.93219897566847876 -0.12986191921779724;0.80288289715891503 -0.07318395052646702 0.76100096283444429 1.0818638298428027 -1.6017025273841767 -0.30063661155961463 -2.0886824404524953 -1.5351050530773851;-2.6628991209942976 -1.6591128716233896 0.0029941544234867185 -0.60622751314163081 0.078502543290495719 1.1661775241962808 0.027441527508689802 0.053532201644238782;0.40707058326830681 -0.082507025167972994 0.47019118424337236 1.4361487190778808 -1.6166263735886481 -1.3282194158036178 -2.0857364029653302 -1.80510980604686;-2.1407378423531247 2.3068512507177723 -0.49751855640073894 -0.55830986696211626 0.40590139749451731 1.2287062705177054 0.15762922229104978 0.11584967233432993;-0.12874376896689688 0.9022766669637835 0.80951029054725343 1.2727031377027018 -1.9834545652994839 -0.91434187429142688 -1.4375171745805839 -0.54236250991715929;1.8857138069100332 0.60911156157733592 1.8193981861236541 0.79074806173009016 -0.16719041692971462 -1.3609066092382966 -0.59297145825152653 -0.21051373045868108;-0.95768721822886838 0.14180330116268897 -3.2482720320798757 -0.55765600903812063 0.51084839946559513 0.88229281424655059 -0.652748870944172 0.60476558187210905;-0.13339105811780866 -0.013075613344132021 2.4629491588820867 -0.10977629390232621 -0.23296093438341295 -0.030373094912373021 -0.6166907459635752 -0.35338679753080571;-0.49451632508373122 0.047597079711154337 -1.0405839402730113 0.073083766922332691 -0.73848316752452081 0.251881912463846 -1.4806934230760884 0.21361462234053771;-0.86632084289732436 0.62742478684400405 -1.2056257300918112 0.12968801027124202 0.023146473247374993 -1.528329241694188 0.53920847562468321 0.16093659344487476;-1.5414248836215139 -5.9876524899052086 0.9148772563287404 -0.0070361584059047272 -0.016807625915479452 0.91609296984923705 -0.29076871526824988 -0.050741370321284715;0.055375146548080956 1.4572849157315029 1.2315771303269247 0.27690838620181252 1.206960897586421 -0.56872226083755084 -0.86174004252170111 0.45072476317579457;-1.2339092572736892 0.018428536462993805 -1.2381780945237322 0.14021103148565769 0.044867810177207812 0.63356349494688957 0.61367507201726135 0.19943598597635162;1.3861537362429603 -0.070509825505762236 1.4506666434484279 0.27765407499325939 0.045973666729378998 0.092584306910482028 -0.6278679089928112 0.21451416580799865;1.247281759042989 -0.0059685273070892286 0.7073119487879318 0.75625143690549201 -0.2537285576086114 -1.7832882942184332 -0.21559232423264701 -0.032081956938050195;-0.71946758359850993 0.48567785975979899 -2.3248651789039241 0.55070925773550461 -0.42536728038033583 1.2599745308130557 -1.4330093317629311 0.56200761078870565;-0.5744385697154003 -2.0687964463245181 0.59246322950019703 0.28921990641354761 -0.2381038982409763 -1.0712043931803217 0.34151845291807403 -0.13780145276123529;0.083835654836234647 -1.6233293644493003 1.5673728086844296 2.7182664399949594 -0.90174578615091938 2.8406060852725767 -0.50593509005668613 -0.22403063216243202;0.2050159765271273 -1.5263220102333772 -1.2163242384653004 -0.38432521303339562 -0.94067111910278689 0.69214831791694631 0.99961693387640105 -0.33365868888405009;-2.2241850095604159 -0.2055290840210538 0.77528783165979032 -0.56216570952878608 0.18769082732658882 2.3428942298313076 -0.30055692868103601 -0.10243357697130943;-0.55686785676061135 0.08228696152933071 -1.0774549263799051 -1.1019223282422383 0.88836393468048336 1.2634785939472519 0.33515903391256108 0.34979458938033214;1.5110251950872462 -0.049865747205693971 1.9235182443324157 0.66589475382262431 -0.42389438049316663 -0.79360783500310994 -0.62160355528522027 -0.28062671320578508;-1.5424868110236065 1.1219313280821193 0.60714713635797746 0.61764047117606868 -0.26620552256895758 -0.90636362653006242 -0.25119801520861695 -0.27387401985840187;-0.14562524392953693 0.23235996934875777 -0.443222869143442 -0.52319820221041147 -0.81165167860319043 0.2065242127321327 0.34238576509888924 0.026792284477849895;-0.28387741805490951 -1.3113696579886185 1.675678686680899 1.1535896487801991 -0.062200641250924428 0.39496723408794437 0.049572362529895539 0.17159160261524117];

% Layer 2
b2 = [-0.085451339346803615;-1.8021641788263485;1.2147029900742086];
LW2_1 = [0.79244583371896338 -0.73944785573108684 2.2764265351965594 -0.64550967414017646 0.57870686555193884 0.94064085792932028 -0.35551500136392522 0.071925348548481899 -0.28033982210910685 0.050992151725399115 -0.80137166324864262 -1.960894064086494 1.0641314275542131 -0.10475866465172227 -0.21992125067518628 -2.8610845215540648 0.10828041459414288 0.1491964815486331 -0.37883605278395316 0.15703902542310819 0.23997539033490878 0.98159679239140174 -1.3262786871688792 0.42769013682329121 0.51302424725406492 0.57797051249343889 -0.09163051382673193 -0.11985821001747547 -0.48808784755411849 -0.38912541206428053 -0.3783858326073628 0.41254257173060233 0.021132702170384175 0.15189518384862102 0.35073120963060461 -0.054029954564531114 -0.98302547319814371 0.1028123884472321 0.28160193896463143 -0.27087442991054905 0.0014892244696017879 -0.69074790558092614 0.066856268259090024 -0.83965779865723789 -0.40210642304264782 -1.5284271439913883 -0.30444714628625541 0.55168225015590977 0.33526468822450978 1.0713723555459782 0.3808813884573698 0.43745381868527117 -0.55950759829341479 -0.40848402647390286 -0.029274654201863894 0.22447895373645169 -0.68783349187655174 0.080375728833972482 0.46019433503778273 -0.051697539219738797 -0.76799426001883897 -1.2866046026313538 -0.0074831375932219689 0.21371205590027692 -1.3105606348605781 0.050566946435060454 -0.10104988709903125 0.36234658206100406 0.75572968974064958 0.63937444446152736 0.28144937728872965 0.4771660352207413 -0.47299201359889276 -0.1285257811580453 -0.49228836719089386 0.079341488945894906 -0.074305578733821542 0.032915251808974248 -1.7288851977626616 0.067090430637592569 -1.5500376184742553 0.13958331426009152 0.016950948588954736 0.24265377165651508 -0.15435395273294927 -0.40688448887899287 -1.0360245698773973 -0.91680517102920989 0.21297187718183613 1.6898214278183541 -0.9279436911823945 -0.41927819417713236 -0.9110594961782621 -0.083218607182748427 0.067245148305842689 -0.013900777529893387 -0.078192228404690034 -1.4722078122965474 0.04609657973974652 -0.34145703494051205 0.81901440259202196 0.57531333901232273 0.085654954091648861 -0.2294387017038787 -0.63438745749180081 -0.046610117980975488 0.1833436800496405 0.20798176227116782 0.31584598130818164 0.33977307305637039 -0.22276978259455271 -0.81114761114554468 -0.041474385510781808 -0.10238243777937862 -0.48418937991364963 -0.16460030676371737 0.34695970200894477 -0.16238742788255961 -0.02631555513991609 0.9284156375953212 -0.96747525439365611 -0.27116813993408384 -0.31811846438108249 -1.1030140550441525 -0.22612481797519049 -0.23433695201087087 -0.1900964065206619 -0.26532452091958303 -0.0059970793872453692 0.42705851719389881 -0.7333104550698657 -0.056157859286751932 -0.1420178265118224 -0.028713339794250819 -0.13610118641952246 -0.66890383049897018 1.3738328825118014 -0.24023225385455851 0.15178310173189655 -0.053623672519832896 -0.24908038879969158 0.085356335343655998 -0.064609970880963222 0.77948813461523259 0.51605924763192534 0.17363308132424307 0.19605893790003073 0.16731229553860572 0.0088684158599453399 -0.17306264711209685;-0.21312811795807787 0.27050645963761755 -1.3107183143250509 0.043672790594840243 0.56416449277232328 -0.68135151324884391 0.49394857892857791 -0.36039809679617368 0.4769058908207337 -0.021766785649109548 0.60092900165577545 0.56463428847228914 -1.3065247662497743 0.054453437956506832 0.012283597869162237 2.6959775691172276 0.59732710460033644 -2.301374827638734 0.025582608417479585 -2.2738506133275669 -0.027602797059128169 -0.32779447774019027 0.22460793040033686 -0.34332660525614261 -0.066713091905826291 0.24945904619073483 0.12485699139031628 0.10911975854560914 0.074383672303884638 0.050046671414182134 0.84302626053334095 0.061940993694902663 -0.035580184704025311 -0.092380733433768916 -0.043365058656775625 -0.047902588140079555 1.2907492591878107 -0.71769572463851017 -0.19730521600873405 0.11724346895781232 1.6828799337313582 0.13047063556455016 -0.14980687828316699 0.28520366815852316 0.25436612281775639 0.9498247042255622 0.014104668717905562 -0.02567978155590199 -0.13567611643070138 -0.17424444422372409 -0.97058316723954075 -0.39390516267309872 0.64485423821706434 0.67750258688450971 0.010685407888304377 0.092675205649885239 0.31940333667583026 -0.019505133162015638 -0.73878597578730398 0.20498036111103543 -0.13921098615343216 0.87094044554483174 0.055519377000625522 -0.41686057804199417 0.80124175018889165 0.22659972608034745 -0.11621271587788529 -1.3212674380748759 -0.20524723337844286 -0.60206989136194555 0.053327455423860477 -0.72428788624734286 -0.20240316204150871 0.62598538561472383 0.32905835225808155 -0.14011929957795619 0.60611907920851849 0.0076108500002540257 0.14922522890220719 0.0064585688145707629 1.6482161707045184 -0.15071637324443585 0.12555375539098834 -0.26428349578481775 0.41058191152716256 0.89885509985685341 1.0800586999486979 0.47273715313935438 -0.27811116151575466 -0.76183452446049871 2.709635105496651 -0.1831729394488209 1.2308809960829179 0.047720601764862335 -0.33851580161918327 0.02932671109092155 -0.077137354825169965 -0.34732448130120702 -0.062346340280185701 -1.0960466248345819 -0.40455578238234097 0.22192888622500734 0.0067718603977994134 -0.20485384381408642 0.30899751042365958 -0.33500663936955888 0.45653141590821689 -0.26670310315289864 0.23974911713750868 -0.46529562478816255 -0.13539362175834094 -0.15649821669677513 0.048907967966144363 -0.0046637416788187008 0.85677899800907198 0.21875858281717334 -0.23685550188878157 -0.1491194479561658 0.025083305484206894 -0.11832255299620748 0.95150001921582539 0.39526921368152446 0.78681881558054456 0.12673818608832466 1.1080003186268759 -0.44247082737758414 -0.14433441489963481 -0.80996325491650245 0.074938595464344282 0.65577707010083308 -0.067593008189612808 0.1080911457570559 0.070566328595567093 0.14160047349873733 0.19346480967445254 -0.24863729759107178 -0.65762215054994466 0.3927656933948771 0.79422611003356192 -0.29548027145436606 0.18517306707295336 -0.012431970588059761 0.035559231585046196 -0.40457316036328744 -0.9091023297714188 -0.055508606614909646 -1.081409811435553 0.02755054761960099 -0.70016932333866388 0.13351779389209142;-0.056468620131302057 0.042118285234249382 -1.8171490488013877 1.5693702636898696 -2.8371476811407694 -2.1527898413861557 0.10807494599892795 0.34658565532426605 0.0052754170093957074 -0.058269572666493817 0.17537172201648613 3.4656456526685373 -1.9577836071680739 -0.072128573052041234 0.015824934952152217 3.8420933658746312 -0.80052880193775544 -0.88893512246635442 0.90792632440717713 -0.63168213154615227 -0.49357312080416704 -1.8473025410079931 2.2346475354692661 -0.2571111440024072 -0.1651103297118503 0.24376706010557098 0.15280948227322863 0.073606129191922179 0.82044309000159787 0.63210167870850831 0.64845044493582393 0.54625553439137287 -0.38258200286686772 0.026496344784413175 -0.098501637594123378 0.07709052468721557 1.5529837491515632 -0.15926001847796636 -0.23204204287494024 0.24777072154265051 -1.3072318658806601 0.95368858572613591 -0.18554523028851364 1.3131183883552071 0.40706394403558527 1.2539964311462284 -0.00085543148345501889 -0.89082438230629446 -0.38661200980767152 -1.0822973402738161 -0.57033110828444844 -0.57036512566882069 0.072313240957125935 -0.021039795832080047 0.045397818780004713 -0.29583900437466676 0.0045896553086865986 -0.08221462733559283 0.025474915989042411 -0.19375754860252586 1.0806849913016823 2.1309655677979302 -0.057919477093740374 0.22346616900275526 1.0731696065557417 -0.33203345646026594 0.26153318616292853 -0.55954224975697719 -1.0249101195534165 -0.26165360975491742 -0.55370760326038559 0.99010160850277551 1.1736541938434413 -0.67997722867102783 0.024853032892096807 0.033519721860808122 0.047588737341655689 -0.043979363339650648 0.035391067516555845 -0.086757271615545029 1.3935620926886523 -0.21290243240568391 -0.17151236249462573 0.21231096515769704 -0.30656805024562889 -1.1952160868087736 0.49147412751144887 1.2033482490554381 -0.2872667999614309 -3.423972541807164 1.4680053244659008 0.64261937830010885 1.3385581900595553 0.053842395234994074 0.19557376073188065 0.0020938115881611666 0.23612365677864289 2.9199093678690136 0.008115998251404747 1.7802962024737188 -1.490104285106197 -0.90860491264742882 -0.10344859783539063 0.99216604486837634 0.15328520606968443 0.27990280563176584 -0.66288208953040739 -0.27380332695875209 -0.30682164574715698 0.052392840033206572 1.1772918268857431 1.1464058061121771 -0.036092285761390008 0.17073240065777176 -0.76794646835688141 0.083556373595556191 -0.31071922412498676 0.85974144910821815 0.015384095951590513 -1.9821623870598557 0.37215731973335658 -0.065709294789410511 -0.39566008234369671 0.042498307875021457 -0.083515485767876915 0.8524866681121378 0.30164467708858134 1.3940556135711 -0.057577255415579752 -1.4604536066723299 0.058307810675882671 0.10530126964188675 0.14413160391092869 -0.10407322221181697 -0.23427162714253094 1.2432819130623034 -0.07548738108911722 0.50106760308530773 -0.89134829922504955 0.78245282029244756 0.26792527772633878 -0.069270877927528007 0.058487697029854124 -0.045305231723405615 -0.74327479521360873 -0.23781026022222074 0.11411785752437009 -0.2379133416748396 0.74326245002735336 0.066299292014401809];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2.10426952182653;1.67393110919781;1.99999999999999];
y1_step1.xoffset = [-0.39822254;0;-3.6022058e-15];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
y1 = y1';

%output is the three gev parameters [kGEV, ¦ÒGEV, ¦ÌGEV]
% when doing the training the kGEV is normalized by devided 10
% so it should return to the normal value
y1(1)=y1(1)*10;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
